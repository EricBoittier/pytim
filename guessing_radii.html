
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Topologies without atomi radii &#8212; Pytim 0.5.3 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.5.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/pytim.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ITIM" href="ITIM.html" />
    <link rel="prev" title="To center or not to center?" href="center.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ITIM.html" title="ITIM"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="center.html" title="To center or not to center?"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Pytim 0.5.3 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="topologies-without-atomi-radii">
<h1>Topologies without atomi radii<a class="headerlink" href="#topologies-without-atomi-radii" title="Permalink to this headline">¶</a></h1>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>if one starts from a configuration/trajectory for which
the atom types/radii are not known, there are two main ways of
feeding the relevant information to the interface constructor.</p>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p><strong>The problem</strong>
Configuration file formats such as the gromos one do not bear
<em>atomtype</em> nor <em>atomic radius</em> information. In this case  Pytim
chooses the corresponding radius using the closest lexycographic
match to MDAnalysis types, <cite>[‘C’, ‘F’, ‘H’, ‘O’, ‘N’, ‘P’, ‘S’]</cite>
or their average value otherwise. This is usually a good enough
compromise, but it is possible to have full control over this. Let’s
start with a “problematic” configuration file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>By initializing the universe, MDAnalysis will immediately warn you
that it failed at guessing the mass atom type ‘M’</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">METHANOL_GRO</span><span class="p">)</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>You can safely ignore any warning about missing atomtypes in
MDAnalysis, and deal with atomtypes only through the Pytim interface.</p>
<p>As there is no specific information in the topology,  the atom types
assigned by MDAnalysis are the first letter in the atom name:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">u</span><span class="o">.</span><span class="n">residues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">types</span>
<span class="go">[&#39;M&#39; &#39;O&#39; &#39;H&#39;]</span>
</pre></div>
</div>
<p>By initializing the interface, Pytim will associate standard radii
to the matching types, and an average radius to the non-matching
ones, issuing no warning, unless specified as shown here:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">guessed radii:  {&#39;H&#39;: 0.4, &#39;M&#39;: 1.207, &#39;O&#39;: 1.05} You can override this by using, e.g.: pytim.ITIM (u,radii_dic={ &#39;H&#39;:1.2 , ... } )</span>
</pre></div>
</div>
<p>In this case no reasonabe match was found for atomtype ‘M’, and the
average value of all radii in the database was associated to it.</p>
<p>If we want to control which radius is being used, we have mainly
two options:</p>
<p><strong>Case 1</strong>
Create an ad-hoc database of radii and supply it to Pytim.</p>
<p>This is done by creating a dictionary with the atomtypes as keys
and radii as values. This database will be used to update the standard
one, which will be therefore extended with the new values. Radii for
existing atomtypes will be overwritten.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">METHANOL_GRO</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydict</span>    <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;M&#39;</span><span class="p">:</span><span class="mf">1.6</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">radii_dict</span><span class="o">=</span><span class="n">mydict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">u</span><span class="o">.</span><span class="n">residues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">radii</span>
<span class="go">[ 1.6  1.5  0. ]</span>
</pre></div>
</div>
<p><strong>Case 2</strong>
Load values from an existing forcefield.</p>
<p>The values of the van der Waals radii present in a topology can be read
using the <cite>pytim_data.vdwradii()</cite>  function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">METHANOL_GRO</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load the radii database from the G43A1 forcefield</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gromos</span> <span class="o">=</span> <span class="n">pytim_data</span><span class="o">.</span><span class="n">vdwradii</span><span class="p">(</span><span class="n">G43A1_TOP</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check which types are available</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">gromos</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;CU1+&#39;, &#39;CDmso&#39;, &#39;OWT3&#39;, &#39;CA2+&#39;, &#39;FE&#39;, &#39;BR&#39;, &#39;MG2+&#39;, &#39;HC&#39;, &#39;OWT4&#39;, &#39;CL-&#39;, &#39;NL&#39;, &#39;CCl4&#39;, &#39;CLCl4&#39;, &#39;CL&#39;, &#39;NE&#39;, &#39;SDmso&#39;, &#39;CH1&#39;, &#39;NZ&#39;, &#39;CH3&#39;, &#39;CH4&#39;, &#39;ODmso&#39;, &#39;NR&#39;, &#39;NT&#39;, &#39;C&#39;, &#39;HChl&#39;, &#39;DUM&#39;, &#39;F&#39;, &#39;H&#39;, &#39;CChl&#39;, &#39;CMet&#39;, &#39;CLChl&#39;, &#39;O&#39;, &#39;N&#39;, &#39;MW&#39;, &#39;P&#39;, &#39;S&#39;, &#39;AR&#39;, &#39;IW&#39;, &#39;CU2+&#39;, &#39;OM&#39;, &#39;CR1&#39;, &#39;MNH3&#39;, &#39;NA+&#39;, &#39;OA&#39;, &#39;SI&#39;, &#39;CH2&#39;, &#39;OW&#39;, &#39;ZN2+&#39;, &#39;OMet&#39;]</span>
</pre></div>
</div>
<p>Often, the atomtypes strings do not correspond to the one used in the
coordinate file or in the trajectory. To fix this one can just update
the database</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gromos</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">gromos</span><span class="p">[</span><span class="s1">&#39;CMet&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gromos</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">gromos</span><span class="p">[</span><span class="s1">&#39;OMet&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">radii_dict</span><span class="o">=</span><span class="n">gromos</span><span class="p">)</span>
</pre></div>
</div>
<div class="toctree-wrapper compound">
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-92682414-1', 'auto');
  ga('send', 'pageview');

</script>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="index.html">Table Of Contents</a></h3>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quick.html">Pytim: Quick Tour</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">How to Install Pytim</a></li>
<li class="toctree-l1"><a class="reference internal" href="micelle.html">Surface of a micelle</a></li>
<li class="toctree-l1"><a class="reference internal" href="center.html">To center or not to center?</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Topologies without atomi radii</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ITIM.html">ITIM</a></li>
<li class="toctree-l1"><a class="reference internal" href="GITIM.html">GITIM</a></li>
<li class="toctree-l1"><a class="reference internal" href="WillardChandler.html">WillardChandler</a></li>
<li class="toctree-l1"><a class="reference internal" href="ChaconTarazona.html">ChaconTarazona</a></li>
<li class="toctree-l1"><a class="reference internal" href="observables.html">Observables</a></li>
<li class="toctree-l1"><a class="reference internal" href="datafiles.html">Datafiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="center.html"
                        title="previous chapter">To center or not to center?</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ITIM.html"
                        title="next chapter">ITIM</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/guessing_radii.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ITIM.html" title="ITIM"
             >next</a> |</li>
        <li class="right" >
          <a href="center.html" title="To center or not to center?"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Pytim 0.5.3 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Marcello Sega.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.
    </div>
  </body>
</html>